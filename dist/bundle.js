(()=>{var e={988:(e,t,r)=>{r(252);const a=r(74),s=r(274),n=r(481),i=r(128),d=r(460),o=r(75),c=r(375),u=r(947),l=r(288),m=r(928),p=r(896),{Error:g}=r(37);let y=null;e.exports={getAdminLoginPage:(e,t,r)=>{try{if(e.session.admin)t.redirect("admin/home");else{let e;t.render("admin/AdminLogin",{CSS:["stylesheet/adminlogin.css"],msg:e}),e=null}}catch(e){r(e)}},postAdminLogin:async(e,t)=>{const{email:r,password:s}=e.body,n=await a.findOne({email:r});n?s==n.password?(e.session.admin=!0,t.redirect("/admin/home")):(y="Password incorrect",t.redirect("/admin")):(y="Check email and password",t.redirect("/admin"))},getAdminHomePage:(e,t)=>{e.session.admin?t.render("admin/Adminhome",{CSS:["stylesheet/style.css"]}):t.redirect("/admin")},getProductsPage:async(e,t)=>{let r=await s.find().sort({_id:-1}).lean();e.session.admin?t.render("admin/products",{productsdetail:r,msg:y}):t.redirect("/admin")},getAddProducts:async(e,t)=>{let r=await n.find().lean(),a=await i.find().lean();e.session.admin?t.render("admin/addProduct",{category:r,brands:a,msg:y}):t.redirect("/admin")},postAddProducts:async(e,t)=>{const{productname:r,category:a,brand:n,quantity:i,prize:d,MRP:o,description:c}=e.body;try{let u;await l(e.files.image[0].path).png().resize(250,250,{kernel:l.kernel.nearest,fit:"contain",position:"center",background:{r:255,g:255,b:255,alpha:0}}).toBuffer((async(m,g,y)=>{if(m)throw m;const w=await l(g).toBuffer();p.writeFileSync(e.files.image[0].path+".png",w),e.files.image[0].filename=e.files.image[0].filename+".png";const h=[];for(const t of e.files.subimage){const e=await l(t.path).resize(250,250,{kernel:l.kernel.nearest,fit:"contain",position:"center",background:{r:255,g:255,b:255,alpha:0}}).toBuffer(),r=await l(e).extract({left:Math.floor(y.width/2)-125,top:Math.floor(y.height/2)-125,width:250,height:250}).toBuffer(),a=t.filename+".png";p.writeFileSync(t.path+".png",r),h.push(a)}return u=new s({productname:r,category:a,brand:n,quantity:i,prize:d,MRP:o,description:c,block:!1,image:e.files.image[0].filename,subimage:h}),await u.save(),t.redirect("/admin/products")}))}catch(e){return y="Please ensure that all details entered are correct.",t.redirect("/admin/addproducts")}},getProductEdit:async(e,t)=>{let r=e.params.id,a=await n.find().lean(),d=await i.find().lean(),o=await s.findOne({_id:r}).lean();e.session.admin?t.render("admin/productedit",{product:o,category:a,brands:d,msg:y}):t.redirect("/admin")},postProductEdit:async(e,t)=>{const{productname:r,category:a,brand:n,quantity:i,prize:d,description:o,MRP:c,_id:u}=e.body;try{let p;if(e.files?.image){const t=e.files.image[0],r=[".jpg",".jpeg",".png",".webp"],a=m.extname(t.originalname).toLowerCase();if(!r.includes(a))throw new g("Invalid image file type")}return e.files?.image&&e.files?.subimage?(await l(e.files.image[0].path).png().resize(250,250,{kernel:l.kernel.nearest,fit:"contain",position:"center",background:{r:255,g:255,b:255,alpha:0}}).toFile(e.files.image[0].path+".png"),e.files.image[0].filename=e.files.image[0].filename+".png",e.files.image[0].path=e.files.image[0].path+".png",p=await s.updateOne({_id:u},{$set:{productname:r,category:a,brand:n,quantity:i,prize:d,MRP:c,description:o,image:e.files.image[0].filename,subimage:e.files.subimage.map((e=>e.filename))}})):!e.files?.image&&e.files?.subimage?p=await s.updateOne({_id:u},{$set:{productname:r,category:a,brand:n,quantity:i,prize:d,MRP:c,description:o,subimage:e.files.subimage.map((e=>e.filename))}}):e.files?.image||e.files?.subimage?e.files?.image&&!e.files?.subimage&&(await l(e.files.image[0].path).png().resize(250,250,{kernel:l.kernel.nearest,fit:"contain",position:"center",background:{r:255,g:255,b:255,alpha:0}}).toFile(e.files.image[0].path+".png"),e.files.image[0].filename=e.files.image[0].filename+".png",e.files.image[0].path=e.files.image[0].path+".png",p=await s.updateOne({_id:u},{$set:{productname:r,category:a,brand:n,quantity:i,prize:d,MRP:c,description:o,image:e.files.image[0].filename}})):p=await s.updateOne({_id:u},{$set:{productname:r,category:a,brand:n,quantity:i,prize:d,MRP:c,description:o}}),t.redirect("/admin/products")}catch(e){return console.error(e),y=" Please check the fields and ensure that they are correct. If the issue persists, please contact the system administrator for further assistance.",t.status(500).send("Internal Server Error")}},blockProduct:async(e,t)=>{try{const r=e.params.id;await s.findByIdAndUpdate({_id:r},{$set:{block:!0}}),t.redirect("/admin/products")}catch(e){console.error(e),t.redirect("/admin/products")}},unblockProduct:async(e,t)=>{try{const r=e.params.id;await s.findByIdAndUpdate({_id:r},{$set:{block:!1}}),t.redirect("/admin/products")}catch(e){console.error(e),t.redirect("/admin/products")}},deleteProductMainImage:async(e,t)=>{try{const r=e.params.id;await s.findByIdAndUpdate(r,{$unset:{image:1}}),t.redirect("/admin/productedit/"+r)}catch(e){console.error(e),t.redirect("/admin/productedit/"+id)}},getCategory:async(e,t)=>{try{const r=await n.find().sort({_id:-1}).lean();e.session.admin?(t.render("admin/AddCategory",{category:r,msg:y}),y=null):t.redirect("/admin")}catch(e){console.error(e),y="Sorry, there was an error",t.render("admin/AddCategory",{category:[],msg:y})}},postAddCategory:async(e,t)=>{try{const{newcategory:r}=e.body,a=r.trim();if(await n.findOne({newcategories:{$regex:new RegExp(`^${a}$`,"i")}}))y="The category you are trying to add already exists.",t.redirect("/admin/AddCategory");else{const e=new n({newcategories:a,block:!1});await e.save(),t.redirect("/admin/AddCategory")}}catch(e){console.error(e),y="Sorry, there was an error adding the category. Please try again later",y=null,t.render("admin/AddCategory",{msg:y})}},blockCategory:async(e,t)=>{try{const r=e.params.id;await n.findByIdAndUpdate({_id:r},{$set:{block:!0}}),t.redirect("/admin/addcategory")}catch(e){t.redirect("/admin/addcategory")}},unblockCategory:async(e,t)=>{try{const r=e.params.id;await n.findByIdAndUpdate({_id:r},{$set:{block:!1}}),t.redirect("/admin/addcategory")}catch(e){t.redirect("/admin/addcategory")}},getCategoryEdit:async(e,t)=>{try{const r=e.params.id,a=await n.findOne({_id:r}).lean();e.session.admin?t.render("admin/categoryEdit",{category:a}):t.redirect("/admin")}catch(e){console.error(e),t.redirect("/admin/addcategory")}},postCategoryEdit:async(e,t)=>{try{const{newcategories:r,_id:a}=e.body;await n.findByIdAndUpdate({_id:a},{$set:{newcategories:r}}),t.redirect("/admin/Addcategory")}catch(e){console.error(e),t.redirect("/admin/addcategory")}},adminLogout:async(e,t)=>{e.session.destroy(),t.redirect("/admin")},getBrand:async(e,t)=>{try{let r=await i.find().sort({_id:-1}).lean();e.session.admin?t.render("admin/brand",{brands:r}):t.redirect("/admin")}catch(e){t.status(500).send("Internal Server Error")}},getAddBrand:(e,t)=>{try{e.session.admin?t.render("admin/addbrand",{msg:y}):t.redirect("/admin")}catch(e){t.status(500).send("Internal Server Error")}},postAddBrand:async(e,t)=>{try{let r=!1;const{brand:a}=e.body,s=a.trim();if(await i.findOne({newbrands:{$regex:new RegExp(`^${s}$`,"i")}}))return y="The brand you are trying to add already exists.",void t.redirect("/admin/addbrand");let n=new i({newbrands:s,block:r,image:e.files.image[0].filename});await n.save(),t.redirect("/admin/brand")}catch(e){t.status(500).send("Internal Server Error")}},getAdminSalesReport:async(e,t)=>{try{let r=new Date((new Date).setDate((new Date).getDate()-8)),a=new Date,s=e.query.filter??"";e.query.startDate&&(r=new Date(e.query.startDate)),e.query.endDate&&(a=new Date(e.query.endDate));const n=new Date;switch(e.query.filter){case"thisYear":r=new Date(n.getFullYear(),0,1),a=new Date(n.getFullYear(),n.getMonth()+1,1);break;case"lastYear":r=new Date(n.getFullYear()-1,0,1),a=new Date(n.getFullYear()-1,11,31);break;case"thisMonth":r=new Date(n.getFullYear(),n.getMonth(),1),a=new Date(n.getFullYear(),n.getMonth()+1,1);break;case"lastMonth":r=new Date(n.getFullYear(),n.getMonth()-1,1),a=new Date(n.getFullYear(),n.getMonth(),1);break;default:e.query.filter||e.query.startDate||(s="lastWeek")}r.setHours(0,0,0,0),a.setHours(24,0,0,0);let i,d,o,c=0;if(e.query.startDate||e.query.endDate||e.query.filter){let t,r,a;e.query.startDate&&(t=new Date(e.query.startDate)),e.query.endDate&&(r=new Date(e.query.endDate)),e.query.filter&&(a=e.query.filter);const s={};t&&r&&(s.date={$gte:t,$lte:r}),a&&(s.filter=a);const n=await u.find(s).sort({date:-1}).lean();c=n.length,i=n.filter((e=>e.orderItems.some((e=>"Delivered"===e.status)))),d=i.reduce(((e,t)=>e+t.totalPrice),0)}else i=await u.find({"orderItems.status":"Delivered"}).populate("orderItems").lean(),i=i.map((e=>(e.date=new Date(e.date).toLocaleString(),e))),c=await u.countDocuments({"orderItems.status":"Delivered"}),o=await u.aggregate([{$match:{"orderItems.status":"Delivered"}},{$unwind:"$orderItems"},{$match:{"orderItems.status":"Delivered"}},{$group:{_id:null,totalPrice:{$sum:"$orderItems.price"}}}]),d=o[0]?.totalPrice;const l=(await u.distinct("user")).length;t.render("admin/salesReport",{userCount:l,salesCount:c,salesSum:d,deliveredOrders:i})}catch(e){throw t.status(404),new g("cant get")}},blockBrand:async(e,t)=>{try{let r=e.params.id;await i.findByIdAndUpdate({_id:r},{$set:{block:!0}}),t.redirect("/admin/brand")}catch(e){y=e,t.status(500).send("Internal Server Error")}},unblockBrand:async(e,t)=>{try{let r=e.params.id;await i.findByIdAndUpdate({_id:r},{$set:{block:!1}}),t.redirect("/admin/brand")}catch(e){t.status(500).send("Internal Server Error")}},getBrandEdit:async(e,t)=>{try{let r=e.params.id,a=await i.findOne({_id:r}).lean();e.session.admin?t.render("admin/brandEdit",{brand:a}):t.redirect("/admin")}catch(e){t.status(500).send("Internal Server Error")}},postBrandEdit:async(e,t)=>{try{const{newbrands:r,_id:a}=e.body;e.files&&e.files.image&&e.files.image[0]?(await i.updateOne({_id:a},{$set:{newbrands:r,image:e.files.image[0].filename}}),t.redirect("/admin/brand")):(await i.updateOne({_id:a},{$set:{newbrands:r}}),t.redirect("/admin/brand"))}catch(e){t.status(500).send("Server error")}},getUsers:async(e,t)=>{try{let r=await d.find().sort({_id:-1}).lean();e.session.admin?t.render("admin/users",{users:r}):t.redirect("/admin")}catch(e){t.status(500).send("Internal Server Error")}},blockUser:async(e,t)=>{try{let r=e.params.id;await d.findByIdAndUpdate({_id:r},{$set:{block:!0}}),t.redirect("/admin/users")}catch(e){t.status(500).send("Internal Server Error")}},unblockUser:async(e,t)=>{try{let r=e.params.id;await d.findByIdAndUpdate({_id:r},{$set:{block:!1}}),t.redirect("/admin/users")}catch(e){t.status(500).send("Internal Server Error")}},getBanner:async(e,t)=>{try{let r=await o.find().sort({_id:-1}).lean();e.session.admin?t.render("admin/banner",{banner:r}):t.redirect("/admin")}catch(e){console.error(e),t.redirect("/admin")}},getAddBanner:(e,t)=>{e.session.admin?(t.render("admin/Addbanner",{msg:y}),y=null):t.redirect("/admin")},PostAddBanner:async(e,t)=>{try{const{name:r,description:a}=e.body,s=new o({name:r,description:a,image:e.files.image[0].filename});await s.save(),t.redirect("/admin/banner")}catch(e){t.render("admin/error404")}},deleteBanner:async(e,t)=>{try{const r=e.params.id;await o.findByIdAndRemove({_id:r}).lean(),t.redirect("/admin/banner")}catch(e){console.error(e),t.redirect("/admin")}},getCoupon:async(e,t)=>{try{let r=await c.find().sort({_id:-1}).lean();e.session.admin?t.render("admin/coupon",{coupon:r}):t.redirect("/admin")}catch(e){t.status(500).send("Error retrieving coupons: "+e)}},getAddCoupon:(e,t)=>{e.session.admin?(t.render("admin/addCoupon",{msg:y}),y=null):t.redirect("/admin")},postAddCoupon:async(e,t)=>{const{name:r,code:a,discount:s,expiration_date:n,minimum_purchase_amount:i,maximum_uses:d}=e.body;try{const e=await c.findOne({name:{$regex:new RegExp(`^${r}$`,"i")}}),o=await c.findOne({code:{$regex:new RegExp(`^${a}$`)}});if(e)return y="Coupon name already exists",t.redirect("/admin/addCoupon");if(o)return y="Coupon code is already exists",t.redirect("/admin/addCoupon");if(new Date(n)<new Date)return y="Expiration date must be after today",t.redirect("/admin/addCoupon");const u=new c({name:r,code:a,discount:s,expiration_date:n,minimum_purchase_amount:i,maximum_uses:d});await u.save(),t.redirect("/admin/coupon")}catch(e){t.status(500).send("Error saving coupon: "+e)}},getCouponEdit:async(e,t)=>{try{const r=e.params.id,a=await c.findOne({_id:r}).lean();e.session.admin?t.render("admin/couponEdit",{coupon:a}):t.redirect("/admin")}catch(e){t.status(500).send("Error retrieving coupon: "+e)}},postCouponEdit:async(e,t)=>{const{name:r,code:a,_id:s,discount:n,expiration_date:i,minimum_purchase_amount:d,maximum_uses:o}=e.body;try{await c.findByIdAndUpdate({_id:s},{$set:{name:r,code:a,discount:n,expiration_date:i,minimum_purchase_amount:d,maximum_uses:o}}),t.redirect("/admin/coupon")}catch(e){t.status(500).send("Error updating coupon: "+e)}},deleteCoupon:async(e,t)=>{try{const r=e.params.id;await c.findByIdAndRemove({_id:r}).lean(),t.redirect("/admin/coupon")}catch(e){t.status(500).send("Error deleting coupon: "+e)}},deleteProductSubImage:async(e,t)=>{},getAllOrders:async(e,t)=>{try{if(!e.session.admin)return t.redirect("/admin");const r=await u.find().sort({_id:-1}).lean();t.render("admin/orders",{orders:r})}catch(e){console.error(e),t.status(500).send("Server error")}},displayOrderStatusEditPage:async(e,t)=>{try{const r=e.params.id,a=await u.findOne({orderItems:{$elemMatch:{_id:r}}}).lean(),s=a.orderItems.find((e=>e._id.toString()===r));t.render("admin/orderStatusEdit",{order:a,orderItem:s})}catch(e){console.error(e),t.status(500).send("Server error")}},updateOrderStatus:async(e,t)=>{try{const{status:r,orderId:a,itemId:s,userId:n,itemPrice:i}=e.body;let o;(await u.findById(a)).orderItems.forEach((e=>{e._id==s&&(e.status=r,"Delivered"===r?(o=e,o.deliveryDate=new Date):"Return completed"===r&&(o=e,o.returnDate=new Date))})),"Return completed"===r&&(await u.updateOne({_id:a,"orderItems._id":s},{$set:{"orderItems.$.status":r,"orderItems.$.returnDate":o?.returnDate}}),await d.updateOne({_id:n},{$inc:{wallet:i}})),await u.updateOne({_id:a,"orderItems._id":s},{$set:{"orderItems.$.status":r,"orderItems.$.deliveredDate":o?.deliveryDate}}),t.redirect("/admin/orders")}catch(e){console.error(e),t.status(500).send("Server error")}},getAdminDashboard:async(e,t)=>{if(!e.session.admin)return t.redirect("/admin");const r=await u.find({"orderItems.status":"Delivered"}).lean();let a=0;r.forEach((e=>{e.orderItems.forEach((e=>{a+=e.price}))}));const n=await u.aggregate([{$match:{"orderItems.status":"Delivered"}},{$addFields:{orderDateConverted:{$toDate:"$date"}}},{$group:{_id:{$month:"$orderDateConverted"},sum:{$sum:"$totalPrice"}}}]);let i={};n.forEach((e=>{i[e._id]=e.sum}));let o=[];for(let e=1;e<=12;e++)o[e-1]=i[e]||0;const c=await u.countDocuments({paymentMethod:"Online-payment"}),l=await u.countDocuments({paymentMethod:"COD"}),m=await d.countDocuments(),p=await s.countDocuments(),g=await u.countDocuments(),y=await u.find().sort({_id:-1}).limit(5).lean(),w=(new Date,new Date((new Date).setDate((new Date).getDate()-7)),await u.aggregate([{$match:{"orderItems.status":"Delivered"}},{$group:{_id:{$dayOfWeek:"$date"},totalPrice:{$sum:"$totalPrice"}}}]));let h={};w.forEach((e=>{h[e._id]=e.orderItems?.price}));let f=[];for(let e=1;e<=7;e++)f[e-1]=h[e]||0;t.render("admin/Adminhome",{weeklyData:f,totalRevenue:a,userCount:m,productCount:p,orderCount:g,orderData:y,monthlyData:o,onlineOrdersCount:c,codOrdersCount:l})},getOrderviewPage:async(e,t)=>{try{const r=e.params.id,a=await u.findById(r).lean();a.date=a.date.toLocaleDateString(),t.render("admin/orders-view",{order:a})}catch(e){console.error(e),t.render("admin/error")}}}},520:(e,t,r)=>{r(252);const a=r(283),s=r(274),n=r(128),i=r(75),d=r(481),o=r(460),c=r(375),u=r(947),l=r(493);var m=r(486);r(288);const p=r(812),g=r(938),{create:y,find:w}=r(274),h=(r(977),r(274));var f=m.genSaltSync(10);let b,_;r(818);var P=null;const $=function(e,t){return p.locale("en"),p(e).tz("Asia/Kolkata").format(t)};var q="";let S;const v=(e,t,r)=>({category:e,brand:t,user:r});let D,I=null;e.exports={getHomePage:async(e,t)=>{let r=await s.find({block:!1}).limit(8).lean(),a=await n.find().limit(4).lean(),d=await i.find().lean(),o=await e.session.user;t.render("users/Home",{CSS:["stylesheet/home.css"],product:r,brand:a,banner:d,user:o})},getAllProductPage:async(e,t)=>{try{const[r,a,i]=await Promise.all([d.find({block:!1}).lean(),n.find({block:!1}).lean(),s.find({block:!1}).lean()]),o=e.session.user,{sortProducts:c,catgproducts:u,brandproducts:l}=e.session;e.session.pageNum=parseInt(e.query.page??1),e.session.perpage=6;let m=await s.countDocuments(),p=await s.find().skip((e.session.pageNum-1)*e.session.perpage).limit(e.session.perpage).lean(),g=Math.ceil(m/e.session.perpage),y=[];for(let e=1;e<=g;e++)y.push(e);if(c)return e.session.sortProducts=null,t.render("users/allProductPage",{sorted:e.session.sorted,products:c,...v(r,a,o)});if(u)return e.session.catgproducts=null,t.render("users/allProductPage",{products:u,...v(r,a,o)});if(l)return e.session.brandproducts=null,t.render("users/allProductPage",{products:l,...v(r,a,o)});t.render("users/allProductPage",{allproducts:p,pagination:y,...v(r,a,o)})}catch(e){}},getProductDetail:async(e,t)=>{try{let r=e.params.id,a=await e.session.user,n=await s.find().limit(4).lean(),i=await s.findOne({_id:r}).select("quantity").lean(),d=await s.findOne({_id:r}).lean(),o=0===i.quantity,c=i.quantity>0&&i.quantity<=5;t.render("users/productDetail",{product:d,products:n,user:a,noQuantity:o,lowQuantity:c})}catch(e){console.error(e),t.status(500).send("Internal Server Error")}},addToCart:async(e,t)=>{try{if(e.session.user){const r=e.session.user._id,a=e.params.id;await o.updateOne({_id:r},{$addToSet:{cart:{id:a,quantity:1}}}),t.json({success:!0})}else t.json({success:!1})}catch(e){console.error(e),t.status(500).json({message:"Server error"})}},getCartPage:async(e,t)=>{try{if(!e.session.user)return t.redirect("/login");const r=e.session.user,a={},n=r._id,i=await o.findOne({_id:n},{cart:1}),d=i.cart.map((e=>(a[e.id]=e.quantity,e.id)));e.session.user.cartQuantity=a;const c=await s.find({_id:{$in:d}}).lean();let u,l=0,m=0;c.forEach(((e,t)=>{const r=a[e._id];c[t].quantity=r,l+=e.prize*a[e._id],m+=e.MRP*a[e._id],e.itemprize=e.prize*e.quantity}));const p=m-l;t.render("users/cart",{products:c,totalAmount:l,cartDetails:i,totalMRP:m,user:r,discount:p,itemprize:u,message:P,cartMessage:I,msg:D}),I=null}catch(e){console.error(e),t.status(500).json({message:"Internal Server Error"})}},removeFromCart:async(e,t)=>{const r=e.session.user._id,a=e.params.id;await o.updateOne({_id:r},{$pull:{cart:{id:a}}}),t.redirect("/cartpage")},incrementQuantity:async(e,t)=>{try{const r=await h.findById(e.params.id),a=(await o.findOne({_id:e.session.user._id,cart:{$elemMatch:{id:e.params.id}}},{"cart.$":1})).cart[0].quantity;if(r.quantity<=a)return t.json({success:!1,message:"Requested quantity not available"});await o.updateOne({_id:e.session.user._id,cart:{$elemMatch:{id:e.params.id}}},{$inc:{"cart.$.quantity":1}}),t.json({success:!0})}catch(e){console.error(e),t.status(500).json({message:"Server error"})}},decrementQuantity:async(e,t)=>{try{const{cart:r}=await o.findOne({"cart.id":e.params.id},{_id:0,cart:{$elemMatch:{id:e.params.id}}});r[0].quantity<=1?(await o.updateOne({_id:e.session.user._id},{$pull:{cart:{id:e.params.id}}}),t.json({success:!1})):(await o.updateOne({_id:e.session.user._id,cart:{$elemMatch:{id:e.params.id}}},{$inc:{"cart.$.quantity":-1}}),t.json({success:!0}))}catch(e){console.error(e),t.status(500).json({message:"Server error"})}},postUserCheckout:async(e,t)=>{try{const r=e.session.user._id,a=(await o.findById(r).lean()).cart,n=a.map((e=>e.id)),{address:i}=await o.findOne({_id:r},{address:1}),d=i.find((t=>t.id==e.body.useraddress)),c=await s.find({_id:{$in:n}}).lean(),m=c.map(((e,t)=>({product:e._id,name:e.productname,image:e.image,quantity:a[t].quantity,price:a[t].quantity*e.prize,deliveredDate:new Date(Date.now()+6048e5)})));let p=0;m.forEach((e=>{p+=e.price}));for(let e=0;e<c.length;e++)if(c[e].quantity<m[e].quantity)return D=`${c[e].productname} is out of stock.`,t.redirect("/checkout");let y=e.session.coupon,w=0;y&&p>y.minimum_purchase_amount&&(w=y.discount,e.session.coupon=null);const h={name:`${d.firstname} ${d.lastname}`,address:`${d.address}`,state:`${d.state}`,pincode:`${d.town} ${d.pincode}`,phoneno:`${d.phonenumber}`};let f=Number(e.session.amount);f&&(await o.updateOne({_id:r},{$inc:{wallet:-f}}),e.session.amount=null);const b=p-(w||0)-(f||0),_=(w||0)+(f||0),{paymentMethod:P}=e.body,$=new u({user:r,orderItems:m,shippingAddress:h,paymentMethod:P,itemsPrice:p,discount:_,totalPrice:b,date:new Date});if(e.session.orders=$,"COD"!==e.body.paymentMethod){let a="order_"+l();const s={method:"POST",url:"https://sandbox.cashfree.com/pg/orders",headers:{accept:"application/json","x-api-version":"2022-09-01","x-client-id":process.env.clientId,"x-client-secret":process.env.clientSecret,"content-type":"application/json"},data:{order_id:a,order_amount:e.body.totalAmount||e.body.discountedPrice,order_currency:"INR",customer_details:{customer_id:r,customer_email:"jamshadjamshu596@gmail.com",customer_phone:"7012257903"},order_meta:{return_url:"https://boltt.store/verifyPayment?order_id={order_id}"}}};await g.request(s).then((function(e){return t.render("users/paymentTemp",{orderId:a,sessionId:e.data.payment_session_id})})).catch((function(e){console.error(e)}))}else{await $.save();for(let e=0;e<c.length;e++)await s.updateOne({_id:c[e]._id},{$inc:{quantity:-m[e].quantity}}),await o.findByIdAndUpdate(r,{$set:{cart:[]}});t.redirect("/orderConfirmed")}}catch(e){console.log(e.message)}},getAddAddress:(e,t)=>{t.render("users/add-New-Address")},postAddAddress:async(e,t)=>{const r=e.session.user._id,{firstname:a,lastname:s,country:n,address:i,state:d,town:c,pincode:u,phonenumber:m,landmark:p}=e.body,g=await o.findById(r);g.address.push({firstname:a,lastname:s,country:n,address:i,state:d,town:c,pincode:u,phonenumber:m,landmark:p,id:l()}),await g.save(),t.redirect("/checkout")},getUserCheckout:async(e,t)=>{const r=e.session.user._id;let a=await e.session.user;const n=await o.findById({_id:r}).lean(),i=n.address,d=n.cart,u={},l=d.map((e=>(u[e.id]=e.quantity,e.id))),m=(await s.find({_id:{$in:l}}).lean()).map((e=>({...e,quantity:u[e._id]})));let p=0;await c.find().lean(),m.forEach(((e,t)=>{const r=u[e._id];m[t].quantity=r,p+=e.prize*u[e._id],e.itemprize=e.prize*e.quantity}));let g=e.session.coupon,y={};new Date,g&&p>g.minimum_purchase_amount&&(y.discountedPrice=p-g.discount,y.discount=g.discount);let w=Number(e.session.amount);w<=p&&w&&(y.walletAmount=w,y.walletPrice=p-w),g&&w&&p>g.minimum_purchase_amount&&w<=p&&w&&(y.lastDiscount=g.discount+w,y.lastPrice=p-g.discount-w);const h=e.session.message;e.session.message=null;const f=e.session.walletPrice;e.session.walletPrice=null,t.render("users/checkout",{products:m,totalAmount:p,address:i,cart:d,coupon:g,cashback:y,itemprize:void 0,users:n,msg:D,message:h,walletmessage:f,user:a}),D=null,y=null},getLoginPage:(e,t)=>{e.session.user?t.redirect("/"):(t.render("users/login",{CSS:["stylesheet/adminlogin.css"],message:P,sucessmessage:q}),P=null,q=null)},postLoginPage:async(e,t)=>{const{email:r,password:a}=e.body,s=await o.findOne({email:r});s?1==s.block?(P="Sorry you are banned",t.redirect("/login")):m.compareSync(a,s.password)?(e.session.user=s,t.redirect("/")):(P="Incorrect password",t.redirect("/login")):(P="Email is not exist",t.redirect("/login"))},getUserSignUpPage:(e,t)=>{t.render("users/userSignup",{CSS:["stylesheet/adminlogin.css"],message:P}),P=null},postSignUpPage:async(e,t)=>{if(await o.findOne({email:e.body.email}))P="Email already exist",t.redirect("/signup");else if(10!=e.body.phoneno.length)P="Mobile number is not vailed",t.redirect("/signup");else if(e.body.password.length<8)P="Please enter password leangth more than 8 charachter",t.redirect("/signup");else if(e.body.password!=e.body.confirmpassword)P="Password is not same",t.redirect("/signup");else{b=e.body,_=e.body.password;let r=Math.floor(1e6*Math.random());signupOTP=r,S=e.body.email,a(e.body.email,r),t.redirect("/otp")}},getOtpPage:(e,t)=>{t.render("users/verifyOTP",{CSS:["stylesheet/adminlogin.css"],message:P,userDetails:b}),P=null},postOtpPage:(e,t)=>{if(signupOTP==e.body.verify){let r=!1;new o({...b,password:m.hashSync(_,f),block:r}).save(((r,a)=>{r?t.render("userSignup",{error:!0,message:"Something went wrong"}):(e.session.user=b,t.redirect("/"))}))}else signupOTP==e.body.forgot?t.redirect("/password"):(t.redirect("/otp"),P="OTP is incorrect")},resendOTP:(e,t)=>{t.redirect("/otp");let r=Math.floor(1e6*Math.random());a(S,r),signupOTP=r,setTimeout((()=>{r=void 0}),12e5)},ForgotPasswordemil:(e,t)=>{t.render("users/forgot-email",{CSS:["stylesheet/adminlogin.css"],message:P}),P=null},postForgotPassword:async(e,t)=>{if(await o.findOne({email:e.body.email})){e.session.email=e.body.email;let r=Math.floor(1e6*Math.random());signupOTP=r,S=e.body.email,a(e.body.email,r),t.redirect("/otp")}else P="Email not exist",t.redirect("/forgot")},postCouponCode:async(e,t)=>{try{const r=await c.findOne({code:e.body.couponcode});r?r.expiration_date<new Date?(e.session.coupon=null,e.session.message="Coupon code has expired",t.redirect("/checkout")):r.maximum_uses&&r.maximum_uses<=r.used_count?(e.session.coupon=null,e.session.message="Coupon code has exceeded maximum uses",t.redirect("/checkout")):(e.session.coupon=r,e.session.message="Coupon code applied successfully",t.redirect("/checkout")):(e.session.coupon=null,e.session.message="Invalid coupon code",t.redirect("/checkout"))}catch(r){console.error(r),e.session.message="An error occurred while processing the coupon code.",t.status(500).render("/checkout",{message:e.session.message})}},getUserPayment:async(e,t)=>{const r=e.session.user._id,a=(await o.findById(r).lean()).cart.map((e=>e.id)),n=await s.find({_id:{$in:a}}).lean(),i={method:"GET",url:"https://sandbox.cashfree.com/pg/orders/"+e.query.order_id,headers:{accept:"application/json","x-api-version":"2022-09-01","x-client-id":"333565b632336d7cea8d6caa61565333","x-client-secret":"fa3273e76456388f4f4498485b16a5647a19b6f1","content-type":"application/json"}};try{if("PAID"===(await g.request(i)).data.order_status){await u.create(e.session.orders);for(let t=0;t<n.length;t++)await s.updateOne({_id:n[t]._id},{$inc:{quantity:-e.session.orders.orderItems[t].quantity}});await o.findByIdAndUpdate(r,{$set:{cart:[]}}),t.redirect("/orderConfirmed")}else t.redirect("/cart")}catch(e){console.error(e),t.redirect("/cart")}},addToWishList:async(e,t)=>{try{if(e.session.user){const r=e.session.user._id,a=e.params.id;await o.updateOne({_id:r},{$addToSet:{wishlist:{id:a}}}),t.json({success:!0})}else t.json({success:!1})}catch(e){console.error(e),t.status(500).json({message:"Server error"})}},getWishlistPage:async(e,t)=>{try{if(!e.session.user)return t.redirect("/login");const r=e.session.user,a=r._id,n=(await o.findOne({_id:a},{wishlist:1})).wishlist.map((e=>e.id)),i=await s.find({_id:{$in:n}}).lean();t.render("users/wish-list",{products:i,user:r})}catch(e){console.error(e),t.status(500).json({message:"Internal Server Error"})}},removeFromWishlist:async(e,t)=>{const r=e.session.user._id,a=e.params.id;await o.updateOne({_id:r},{$pull:{wishlist:{id:a}}}),t.redirect("/wish-list")},getEditAddress:async(e,t)=>{const r=e.session.user,a=e.params.id;let{address:s}=await o.findOne({_id:r._id},{address:1}).lean(),n=s.find((e=>e.id==a));r?t.render("users/editAddress",{data:n}):t.redirect("/")},postEditAddress:async(e,t)=>{try{await o.updateOne({_id:e.session.user._id,"address.id":e.body.id},{$set:{"address.$.firstname":e.body.firstname,"address.$.lastname":e.body.lastname,"address.$.country":e.body.country,"address.$.address":e.body.address,"address.$.landmark":e.body.landmark,"address.$.state":e.body.state,"address.$.town":e.body.town,"address.$.pincode":e.body.pincode,"address.$.phonenumber":e.body.phonenumber}}),t.redirect("/profile")}catch(e){console.error(e),t.render("404page")}},wishListToCart:async(e,t)=>{try{if(e.session.user){const r=e.session.user._id,a=e.params.id;await o.updateOne({_id:r},{$addToSet:{cart:{id:a,quantity:1}}}),await o.updateOne({_id:r},{$pull:{wishlist:{id:a}}}),t.json({success:!0})}else t.json({success:!1})}catch(e){console.error(e),t.status(500).json({message:"Server error"})}},categorySelect:async(e,t)=>{try{let r=await s.find({category:e.query.catgy,block:!1}).lean(),a=e.query.catgy;e.session.catgproducts=r,e.session.catstatus=a,t.redirect("/productpage")}catch(e){t.render("errorpage",{error:!0,message:"Something went wrong. Please try again later."})}},brandSelect:async(e,t)=>{const r=e.query.brand;try{const a=await s.find({brand:r,block:!1}).lean();let n=e.query.brand;e.session.brandproducts=a,e.session.brandstatus=n,t.redirect("/productpage")}catch(e){t.render("errorpage",{error:!0,message:"Something went wrong. Please try again later."})}},postSearchProduct:async(e,t)=>{try{const[r,a]=await Promise.all([d.find({block:!1}).lean(),n.find({block:!1}).lean()]);if(e.body.name){const n=await s.find({$and:[{status:"available"},{$or:[{productname:new RegExp(e.body.name,"i")},{category:new RegExp(e.body.name,"i")}]}]}).lean();t.render("users/allProductPage",{products:n,category:r,brand:a})}else t.render("users/allProductPage",{category:r,brand:a})}catch(e){t.render("admin/error404")}},priceSorting:async(e,t)=>{try{const r=e.query.sort||"asc";let a,n=!0;a=e.session.brandstatus?await s.find({brand:e.session.brandstatus}).sort({prize:"asc"===r?1:-1}).lean():e.session.catstatus?await s.find({category:e.session.catstatus}).sort({prize:"asc"===r?1:-1}).lean():await s.find().sort({prize:"asc"===r?1:-1}).lean(),e.session.sortProducts=a,e.session.sorted=n,t.redirect("/productpage")}catch(e){t.redirect("/404")}},getProfile:async(e,t)=>{try{const r=e.session.user._id,a=await o.findById(r).lean(),s=a.address;t.render("users/profile",{user:a,address:s})}catch(e){console.error(e),t.status(500).send("Server Error")}},getOrderHistory:async(e,t)=>{const r=e.session.user,a=await u.find({user:r._id}).sort({date:-1}).lean();t.render("users/ordersHistory",{formatDate:$,user:r,orders:a})},userLogout:(e,t)=>{e.session.destroy(),t.redirect("/")},getOrders:async(e,t)=>{const r=e.session.user,a=e.params.id,n=await u.findOne({orderItems:{$elemMatch:{_id:a}}}).lean();if(!n)return t.status(404).send("Order not found");const i=n.orderItems.find((e=>e._id.toString()===a)),d=i.product,o=await s.findOne({_id:d,reviews:{$elemMatch:{user:n.user}}},{reviews:{$elemMatch:{user:n.user}}}).lean(),c=new Date(i.deliveredDate);c.setDate(c.getDate()+7);const l=c.toLocaleDateString(),m="Delivered"===i.status&&new Date<c;t.render("users/order-History-View",{formatDate:$,orderItem:i,user:r,order:n,returnFinished:l,isOrderReturnable:m,review:o})},getVerifiedOrder:async(e,t)=>{let r=await e.session.user;t.render("users/order-confirmed",{user:r})},postAddReview:async(e,t)=>{const{productId:r,rating:a,comment:s,Id:n,user:i}=e.body;try{await h.findOneAndUpdate({_id:r},{$push:{reviews:{rating:a,comment:s,user:i}}}),t.redirect(`/orders/${n}`)}catch(e){t.status(500).json({success:!1,error:e.message})}},orderCancel:async(e,t)=>{try{const{orderId:r,orderItemId:a,userId:s,itemPrice:n}=e.body,i=await u.findOne({_id:r}),d=i.paymentMethod,c=(await u.findOne({_id:r,"orderItems._id":a})).orderItems.find((e=>e._id==a)).price,l=i.orderItems.length,m=c-i.discount/l,p=i.totalPrice-m;"Online-payment"===d?(await u.updateOne({_id:r,"orderItems._id":a},{totalPrice:p,"orderItems.$.status":"Cancelled","orderItems.$.deliveredDate":null,"orderItems.$.cancelledDate":new Date}),await o.updateOne({_id:s},{$inc:{wallet:n}})):await u.updateOne({_id:r,"orderItems._id":a},{totalPrice:p,"orderItems.$.status":"Cancelled","orderItems.$.deliveredDate":null,"orderItems.$.cancelledDate":new Date}),t.redirect(`/orders/${a}`)}catch(e){console.error(e),t.status(500).send("An error occurred while cancelling the order.")}},orderReturn:async(e,t)=>{const{orderId:r,orderItemId:a}=e.body;await u.updateOne({_id:r,"orderItems._id":a},{"orderItems.$.status":"Return requested","orderItems.$.returnDate":new Date}),t.redirect(`/orders/${a}`)},useWallet:async(e,t)=>{const r=e.session.user._id,a=(await o.findOne({_id:r})).wallet;e.body.amount>a?(e.session.walletPrice="please check the wallet balance",t.redirect("/checkout")):(e.session.amount=e.body.amount,t.redirect("/checkout"))},deleteAddress:async(e,t)=>{const r=e.session.user._id,a=e.params.id;try{await o.findOneAndUpdate({_id:r},{$pull:{address:{id:a}}},{new:!0}),t.redirect("/profile")}catch(e){t.status(500).json({message:"Failed to delete address",error:e})}},getChangePassword:async(e,t)=>{t.render("users/updatePassword",{CSS:["stylesheet/adminlogin.css"],message:P}),P=null},postChangePassword:async(e,t)=>{const{password:r,confirmPassword:a}=e.body,s=e.session.email;try{if(r.length<8)P="Password length must be 8 or more characters";else{if(r===a)return await o.findOneAndUpdate({email:s},{$set:{password:m.hashSync(r,f)}},{new:!0}).lean(),q="Password updated successfully",void t.redirect("/login");P="Password and confirm password do not match"}}catch(e){console.error(e),P="An error occurred while updating the password"}t.redirect("/password")}}},797:(e,t,r)=>{const a=r(37);e.exports=()=>{a.set("strictQuery",!0),a.connect("mongodb+srv://jamshad:123123123@bolt.mrga1o5.mongodb.net/?retryWrites=true&w=majority&appName=bolt",{useNewUrlParser:!0,useUnifiedTopology:!0}).then((()=>console.log("Connected to MongoDB Atlas!"))).catch((e=>{console.error("Error connecting to MongoDB Atlas:",e)}))}},493:e=>{e.exports=function(){var e=new Date;return"id"+[e.getYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()].join("")}},283:(e,t,r)=>{const a=r(572);e.exports=(e,t)=>new Promise(((r,s)=>{let n=a.createTransport({host:"smtp.gmail.com",port:465,secure:!0,tls:{rejectUnauthorized:!1},auth:{user:process.env.email,pass:process.env.password}});var i={from:"jamshadalij2004@gmail.com",to:e,subject:"Bolt Email verification",html:`\n            <h1>Verify Your Email For BOLT</h1>\n              <h3>use this code to verify your email</h3>\n              <h2>${t}</h2>\n            `};n.sendMail(i,(function(e,a){e?(console.log("email sent error ",e),s(e)):(console.log("email sent successfull"),r(t))}))}))},970:e=>{e.exports=function(e,t,r){e.session.admin?r():t.redirect("/admin")}},240:(e,t,r)=>{const a=r(460);e.exports=async function(e,t,r){try{const s=await a.findOne({_id:e.session.user?._id});s&&!s.block?(e.user=s,r()):(e.session.user=null,t.redirect("/login"))}catch(e){console.error(e),t.status(500).send("Internal Server Error")}}},394:(e,t,r)=>{const a=r(461),s=a.diskStorage({destination:function(e,t,r){r(null,"public/photos/")},filename:function(e,t,r){const a=Date.now();r(null,t.fieldname+"-"+a+".jpg")}}),n=a({storage:s}).fields([{name:"image",maxCount:1},{name:"subimage",maxCount:3}]);e.exports={multiUpload:n,ids:[]}},460:(e,t,r)=>{const a=r(37),s=new a.Schema({name:{type:String,required:!0},email:{type:String,required:!0},phoneno:{type:String,required:!0},password:{type:String,required:!0},cart:{type:Array,default:[]},wishlist:{type:Array,default:[]},address:{type:Array,default:[]},wallet:{type:Number,default:0},block:{type:Boolean,required:!0}}),n=new a.model("UserDetails",s);e.exports=n},74:(e,t,r)=>{const a=r(37),s=new a.Schema({email:{type:String,required:!0},password:{type:String,required:!0}}),n=new a.model("admin",s);e.exports=n},75:(e,t,r)=>{const a=r(37),s=new a.Schema({name:{type:String,required:!0},description:{type:String,required:!0},image:{type:Object,required:!0}}),n=new a.model("banner",s);e.exports=n},128:(e,t,r)=>{const a=r(37),s=new a.Schema({newbrands:{type:String,required:!0},image:{type:Object,required:!0},block:{type:Boolean,required:!0}}),n=new a.model("NewBrand",s);e.exports=n},481:(e,t,r)=>{const a=r(37),s=new a.Schema({newcategories:{type:String,required:!0},block:{type:Boolean,required:!0}}),n=new a.model("NewCategory",s);e.exports=n},375:(e,t,r)=>{const a=r(37),s=new a.Schema({name:{type:String,required:!0},code:{type:String,unique:!0,required:!0},discount:{type:Number,required:!0},expiration_date:{type:Date,required:!0},minimum_purchase_amount:{type:Number,required:!0},maximum_uses:{type:Number},status:{type:String,default:"available"}}),n=new a.model("coupon",s);e.exports=n},947:(e,t,r)=>{const a=r(37),s=new a.Schema({user:{type:a.Schema.Types.ObjectId,required:!0},orderItems:[{product:{type:a.Schema.Types.ObjectId,required:!0},name:{type:String,required:!0},image:{type:String,required:!0},quantity:{type:Number,required:!0},price:{type:Number,required:!0},deliveredDate:{type:Date,required:!0},cancelledDate:{type:Date},returnDate:{type:Date},status:{type:String,enum:["pending","processing","shipped","delivered","cancelled"],default:"pending"}}],shippingAddress:{type:Object,required:!0},paymentMethod:{type:String,required:!0},itemsPrice:{type:Number,required:!0},discount:{type:Number,default:0},totalPrice:{type:Number,required:!0},date:{type:Date,required:!0}});e.exports=a.model("Order",s)},274:(e,t,r)=>{const{ObjectId:a}=r(518),s=r(37),n=new s.Schema({productname:{type:String,required:!0},category:{type:String},brand:{type:String},quantity:{type:Number,required:!0},prize:{type:Number,required:!0},MRP:{type:Number,required:!0},description:{type:String,required:!0},image:{type:Object,required:!0},subimage:{type:Object,required:!0},block:{type:Boolean,required:!0},reviews:[{rating:{type:Number},comment:{type:String},user:{type:a}}]}),i=s.model("Product",n);e.exports=i},727:(e,t,r)=>{const a=r(252).Router(),{getAdminLoginPage:s,postAdminLogin:n,getAdminHomePage:i,adminLogout:d,getProductsPage:o,getAddProducts:c,postAddProducts:u,getProductEdit:l,postProductEdit:m,blockProduct:p,unblockProduct:g,deleteProductMainImage:y,getCategory:w,postAddCategory:h,getCategoryEdit:f,postCategoryEdit:b,blockCategory:_,unblockCategory:P,getBrand:$,getAddBrand:q,postAddBrand:S,getBrandEdit:v,postBrandEdit:D,blockBrand:I,unblockBrand:O,getUsers:k,blockUser:A,unblockUser:C,getBanner:x,getAddBanner:E,PostAddBanner:B,deleteBanner:M,getCoupon:j,getAddCoupon:U,postAddCoupon:R,getCouponEdit:T,postCouponEdit:z,deleteCoupon:F,getAdminSalesReport:L,getAdminDashboard:N,getAllOrders:H,displayOrderStatusEditPage:W,updateOrderStatus:Y,getOrderviewPage:Q}=r(988),V=r(970),{multiUpload:K}=r(394);a.get("/",s),a.get("/home",N),a.post("/adminlogin",n),a.get("/logout",d),a.use(V),a.get("/products",o),a.get("/addproducts",c),a.post("/addproducts",K,u),a.get("/productedit/:id",l),a.post("/productedit",K,m),a.get("/blockproduct/:id",p),a.get("/unblockproduct/:id",g),a.get("/deleteimage/:id",y),a.get("/addcategory",w),a.post("/addcategory",h),a.get("/blockcategory/:id",_),a.get("/unblockcategory/:id",P),a.get("/categoryedit/:id",f),a.post("/categoryedit",b),a.get("/brand",$),a.get("/addbrand",q),a.post("/addbrand",K,S),a.get("/blockbrand/:id",I),a.get("/unblockbrand/:id",O),a.get("/brandedit/:id",v),a.post("/brandedit",K,D),a.get("/users",k),a.get("/blockuser/:id",A),a.get("/unblockuser/:id",C),a.get("/banner",x),a.get("/addbanner",E),a.post("/addbanner",K,B),a.get("/deletebanner/:id",M),a.get("/coupon",j),a.get("/addcoupon",U),a.post("/addcoupon",R),a.get("/couponedit/:id",T),a.post("/couponedit",z),a.get("/deletecoupon/:id",F),a.get("/orders",H),a.get("/orderStatus/:id",W),a.post("/orderStatus",Y),a.get("/orderview/:id",Q),a.get("/salesreport",V,L),e.exports=a},121:(e,t,r)=>{const{Router:a}=r(252),s=r(252),n=r(240),i=s.Router(),{getHomePage:d,getProfile:o,getLoginPage:c,postLoginPage:u,getUserSignUpPage:l,postSignUpPage:m,getOtpPage:p,postOtpPage:g,resendOTP:y,ForgotPasswordemil:w,postForgotPassword:h,userLogout:f,getChangePassword:b,postChangePassword:_,getAllProductPage:P,getProductDetail:$,categorySelect:q,brandSelect:S,priceSorting:v,postSearchProduct:D,addToCart:I,getCartPage:O,removeFromCart:k,incrementQuantity:A,decrementQuantity:C,getWishlistPage:x,addToWishList:E,removeFromWishlist:B,getUserCheckout:M,postCouponCode:j,postUserCheckout:U,getUserPayment:R,getVerifiedOrder:T,getAddAddress:z,postAddAddress:F,getEditAddress:L,postEditAddress:N,getOrderHistory:H,getOrders:W,orderCancel:Y,orderReturn:Q,postAddReview:V,useWallet:K,wishListToCart:G,deleteAddress:J}=r(520);i.get("/",d),i.get("/login",c),i.post("/login",u),i.get("/signup",l),i.post("/signup",m),i.get("/otp",p),i.post("/otp",g),i.get("/resend",y),i.get("/forgot",w),i.post("/forgot",h),i.get("/add-new-address",n,z),i.post("/add-new-address",n,F),i.get("/password",b),i.post("/password",_),i.get("/profile",n,o),i.get("/productpage",P),i.get("/product/:id",$),i.post("/search-product",D),i.get("/addtocart/:id",n,I),i.get("/cartpage",n,O),i.post("/applycoupon",n,j),i.get("/wish-list",n,x),i.get("/addtowishlist/:id",n,E),i.get("/wishListToCart/:id",n,G),i.get("/removeFromWishList/:id",n,B),i.get("/checkout",n,M),i.post("/placeorder",n,U),i.get("/verifyPayment",n,R),i.get("/orderConfirmed",n,T),i.get("/removeFromCart/:id/:quantity",n,k),i.get("/incrementQuantity/:id",n,A),i.get("/decrementQuantity/:id",n,C),i.get("/edit-address/:id",n,L),i.post("/edit-address",n,N),i.post("/deleteAddress/:id",n,J),i.get("/order-history",n,H),i.get("/orders/:id",n,W),i.post("/cancel",n,Y),i.post("/return",n,Q),i.post("/addReviews",n,V),i.post("/applywallet",n,K),i.get("/categoryproduct",q),i.get("/brandproduct",S),i.get("/priceSorting",v),i.get("/logout",f),e.exports=i},938:e=>{"use strict";e.exports=require("axios")},486:e=>{"use strict";e.exports=require("bcrypt")},268:e=>{"use strict";e.exports=require("body-parser")},818:e=>{"use strict";e.exports=require("dotenv")},252:e=>{"use strict";e.exports=require("express")},707:e=>{"use strict";e.exports=require("express-handlebars")},977:e=>{"use strict";e.exports=require("express-session")},156:e=>{"use strict";e.exports=require("handlebars")},716:e=>{"use strict";e.exports=require("moment")},812:e=>{"use strict";e.exports=require("moment-timezone")},518:e=>{"use strict";e.exports=require("mongodb")},37:e=>{"use strict";e.exports=require("mongoose")},461:e=>{"use strict";e.exports=require("multer")},572:e=>{"use strict";e.exports=require("nodemailer")},288:e=>{"use strict";e.exports=require("sharp")},896:e=>{"use strict";e.exports=require("fs")},928:e=>{"use strict";e.exports=require("path")}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}(()=>{const e=r(252),t=r(707),a=r(156);var s=r(268);const n=r(977),i=r(156),d=r(716),o=e(),c=(r(818).config(),r(727)),u=r(121),l=r(797);o.use(n({secret:"key",resave:!1,saveUninitialized:!0})),o.use(s.json({limit:"10mb"})),o.use(s.urlencoded({limit:"10mb",extended:!0})),o.use((function(e,t,r){t.header("Cache-Control","private, no-cache, no-store, must-revalidate"),r()})),a.registerHelper("formatDate",(function(e,t){return d.locale("en"),d(e).tz("Asia/Kolkata").format(t)})),i.registerHelper("inc",(function(e,t){return parseInt(e)+1})),i.registerHelper("ifEqual",(function(e,t,r){return e===t?r.fn(this):r.inverse(this)})),o.use(e.static(__dirname+"/public")),l(),o.engine("hbs",t.engine({extname:".hbs"})),o.set("view engine","hbs"),o.use(s.urlencoded({extended:!1})),o.use("/admin",c),o.use("/",u),o.use("*",((e,t)=>{t.render("admin/error404")})),o.listen(3e3,console.log("server started at port number 3000"))})()})();